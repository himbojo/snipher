
# Mapping from IANA Cipher Suite Name to OpenSSL Name
# Source: https://testssl.sh/openssl-iana.mapping.html and manual verification
# This list tries to cover a wide range of protocols from SSLv2 to TLS 1.3

IANA_TO_OPENSSL = {
    # TLS 1.3
    "TLS_AES_256_GCM_SHA384": "TLS_AES_256_GCM_SHA384",
    "TLS_CHACHA20_POLY1305_SHA256": "TLS_CHACHA20_POLY1305_SHA256",
    "TLS_AES_128_GCM_SHA256": "TLS_AES_128_GCM_SHA256",
    "TLS_AES_128_CCM_SHA256": "TLS_AES_128_CCM_SHA256",
    "TLS_AES_128_CCM_8_SHA256": "TLS_AES_128_CCM_8_SHA256",

    # TLS 1.2 - ECDHE
    "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384": "ECDHE-ECDSA-AES256-GCM-SHA384",
    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384": "ECDHE-RSA-AES256-GCM-SHA384",
    "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256": "ECDHE-ECDSA-AES128-GCM-SHA256",
    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256": "ECDHE-RSA-AES128-GCM-SHA256",
    "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256": "ECDHE-ECDSA-CHACHA20-POLY1305",
    "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256": "ECDHE-RSA-CHACHA20-POLY1305",
    "TLS_ECDHE_ECDSA_WITH_AES_256_CCM": "ECDHE-ECDSA-AES256-CCM",
    "TLS_ECDHE_ECDSA_WITH_AES_128_CCM": "ECDHE-ECDSA-AES128-CCM",
    "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384": "ECDHE-ECDSA-AES256-SHA384",
    "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384": "ECDHE-RSA-AES256-SHA384",
    "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256": "ECDHE-ECDSA-AES128-SHA256",
    "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256": "ECDHE-RSA-AES128-SHA256",
    "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA": "ECDHE-ECDSA-AES256-SHA",
    "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA": "ECDHE-RSA-AES256-SHA",
    "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA": "ECDHE-ECDSA-AES128-SHA",
    "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA": "ECDHE-RSA-AES128-SHA",
    
    # TLS 1.2 - DHE
    "TLS_DHE_RSA_WITH_AES_256_GCM_SHA384": "DHE-RSA-AES256-GCM-SHA384",
    "TLS_DHE_RSA_WITH_AES_128_GCM_SHA256": "DHE-RSA-AES128-GCM-SHA256",
    "TLS_DHE_RSA_WITH_AES_256_CBC_SHA256": "DHE-RSA-AES256-SHA256",
    "TLS_DHE_RSA_WITH_AES_128_CBC_SHA256": "DHE-RSA-AES128-SHA256",
    "TLS_DHE_RSA_WITH_AES_256_CBC_SHA": "DHE-RSA-AES256-SHA",
    "TLS_DHE_RSA_WITH_AES_128_CBC_SHA": "DHE-RSA-AES128-SHA",
    "TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA": "DHE-RSA-CAMELLIA256-SHA",
    "TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA": "DHE-RSA-CAMELLIA128-SHA",

    # TLS 1.0/1.1/1.2 - RSA
    "TLS_RSA_WITH_AES_256_GCM_SHA384": "AES256-GCM-SHA384",
    "TLS_RSA_WITH_AES_128_GCM_SHA256": "AES128-GCM-SHA256",
    "TLS_RSA_WITH_AES_256_CBC_SHA256": "AES256-SHA256",
    "TLS_RSA_WITH_AES_128_CBC_SHA256": "AES128-SHA256",
    "TLS_RSA_WITH_AES_256_CBC_SHA": "AES256-SHA",
    "TLS_RSA_WITH_AES_128_CBC_SHA": "AES128-SHA",
    "TLS_RSA_WITH_CAMELLIA_256_CBC_SHA": "CAMELLIA256-SHA",
    "TLS_RSA_WITH_CAMELLIA_128_CBC_SHA": "CAMELLIA128-SHA",
    "TLS_RSA_WITH_3DES_EDE_CBC_SHA": "DES-CBC3-SHA",
    "TLS_RSA_WITH_RC4_128_SHA": "RC4-SHA",
    "TLS_RSA_WITH_RC4_128_MD5": "RC4-MD5",
    "TLS_RSA_WITH_SEED_CBC_SHA": "SEED-SHA",
    "TLS_RSA_WITH_IDEA_CBC_SHA": "IDEA-CBC-SHA",

    # SSLv3 (some overlap with TLS 1.0)
    # OpenSSL names often don't distinguish version, but these are old
    "SSL_CK_RC4_128_WITH_MD5": "RC4-MD5",
    "SSL_CK_RC4_128_EXPORT40_WITH_MD5": "EXP-RC4-MD5",
    "SSL_CK_RC2_128_CBC_WITH_MD5": "RC2-CBC-MD5",
    "SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5": "EXP-RC2-CBC-MD5",
    "SSL_CK_IDEA_128_CBC_WITH_MD5": "IDEA-CBC-MD5",
    "SSL_CK_DES_64_CBC_WITH_MD5": "DES-CBC-MD5",
    "SSL_CK_DES_64_CBC_WITH_SHA": "DES-CBC-SHA",
    "SSL_CK_DES_192_EDE3_CBC_WITH_MD5": "DES-CBC3-MD5",
    "SSL_CK_DES_192_EDE3_CBC_WITH_SHA": "DES-CBC3-SHA",

    # SSLv2
    "SSL_CK_RC4_128_WITH_MD5_SSL2": "RC4-MD5",
    "SSL_CK_RC4_128_EXPORT40_WITH_MD5_SSL2": "EXP-RC4-MD5",
    "SSL_CK_RC2_128_CBC_WITH_MD5_SSL2": "RC2-CBC-MD5",
    "SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5_SSL2": "EXP-RC2-CBC-MD5",
    "SSL_CK_IDEA_128_CBC_WITH_MD5_SSL2": "IDEA-CBC-MD5",
    "SSL_CK_DES_64_CBC_WITH_MD5_SSL2": "DES-CBC-MD5",
    "SSL_CK_DES_192_EDE3_CBC_WITH_MD5_SSL2": "DES-CBC3-MD5",

    # Weak / Export / Null
    "TLS_RSA_WITH_NULL_SHA": "NULL-SHA",
    "TLS_RSA_WITH_NULL_MD5": "NULL-MD5",
    "TLS_ECDHE_ECDSA_WITH_NULL_SHA": "ECDHE-ECDSA-NULL-SHA",
    "TLS_ECDHE_RSA_WITH_NULL_SHA": "ECDHE-RSA-NULL-SHA",
    "TLS_RSA_EXPORT_WITH_RC4_40_MD5": "EXP-RC4-MD5",
    "TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5": "EXP-RC2-CBC-MD5",
    "TLS_RSA_EXPORT_WITH_DES40_CBC_SHA": "EXP-DES-CBC-SHA",
    "TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA": "EXP-EDH-RSA-DES-CBC-SHA",
}

def get_openssl_name(iana_name):
    return IANA_TO_OPENSSL.get(iana_name, iana_name)

def get_all_openssl_names():
    return list(set(IANA_TO_OPENSSL.values()))
